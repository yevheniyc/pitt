Source: https://www.coursera.org/learn/mds-introduction-to-data-centric-computing/lecture/74siM/visualizing-the-predicted-trend-uncertainty

English
The predicted trend, this line is never enough,
even though unfortunately,
that's all you'll get sometimes.
All you'll get is just this trend line.
But that's not enough.
We need to express the uncertainty;
the confidence interval on the average.
Essentially, what we're doing is we are going to use
the standard error on
the coefficients to get the standard error on the trend.
But don't worry, you don't have
to simulate anything to do this.
We will use stats models
to pull out the predictive uncertainty.
Now, the way to go about doing this is rather odd,
it's really a two step process.
Stats models provides a two step process for
extracting the predictive uncertainty on the predictions.
The first step, step 1,
call the.get_prediction method on the fitted object.
Now I'm going to assign this to the predictions object.
Predictions = lm_fit.get_prediction applied to df_viz.
Predictions is a weird data type.
It is a stats models data type prediction results.
Step 2, call
the.summary_frame method on the prediction object.
Step 1, you use
the fitted object, get prediction method.
Step 2, apply
the summary frame method on the prediction object.
I will typically name this
the lm_pred_summary, predictions.summary_frame.
This result is a DataFrame.
You have as many rows as prediction points.
You have a column mean.
This is the mean trend, the average output.
You have the standard error on the mean.
Then you have the mean CI lower and upper.
This is the lower and upper bounds
of the confidence interval.
By default, this is
the 95% confidence interval on
the mean output or the trend, as I like to call it.
On the trend. This lm_pred_summary
is a DataFrame that's really telling
you how does the output behave on average?
What's the standard error on the average output?
And what's the 95% confidence interval on the average?
We'll talk about these two columns shortly.
But let's first visualize
the 95% confidence interval on
the mean output using ribbons.
That means we need to use the same methods that we talked
about for when we
visualized the uncertainty or
variability on the trend when we generated the data.
We will use the fill between method for the axis object.
But what's important here is that
we are now using these ribbons,
the fill between,
for a completely different context.
We are expressing the uncertainty in the mean output.
Let's see how to do that and then we will talk about it.
It will follow what we did here.
But there are a couple additional steps.
You must first initialize the figure and axis object,
so just like we've done previously.
Now let's include in
some comments to state what we're going to do.
Let's show the confidence interval,
the uncertainty on the mean output.
Then we will show the output mean,
the predictive trend which
is essentially the best fit line.
Then we will include the training data for contacts,
set the labels,
and show the plot, so plt.show.
To show the confidence interval,
we need to fill between method.
This fill between df_viz _copy,
we need the x input value.
Then the lower bound
comes from the lm_pred_summary.mean_ci_lower.
The upper bound comes from lm_pred_summary.mean_ci_upper.
I like to have the confidence interval as a gray ribbon,
and I like to set the edge color as gray.
As you can see, we have this gray region.
But what's the best fit line?
Well, that's df_viz,
and we'll use.copy and lm_pred_summary.mean.
But because mean is a reserved word,
this is where the bracket notation is helpful.
Rather than doing.mean,
which would be ambiguous if
we're applying the mean or using the mean column,
I'm now using the bracket notation with the string.
Let's set the color of this best fit line to be black
and we can make the line with whatever we want it to be.
That black line is our predictive trend.
But now we have the context of how uncertain are we
of the average given the training data.