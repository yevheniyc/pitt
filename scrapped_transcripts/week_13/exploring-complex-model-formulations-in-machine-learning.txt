Source: https://www.coursera.org/learn/mds-introduction-to-data-centric-computing/lecture/otCPD/exploring-complex-model-formulations-in-machine-learning

English
Now we have a model with all of the inputs,
continuous and categorical,
a model that interacts categorical with continuous,
a model that interacts all the continuous.
But we could also have a model that derives
nonlinear features from the continuous.
Here, a very simple set of nonlinear features,
is to square each continuous input.
This model has
the linear additive main effects and quadratic features.
This model does not involve the categorical,
which means the next model
should add in the effect of the categorical.
Now I'm just going to copy that previous line down.
X5 plus the continuous linear additive features
with the quadratic features.
If I'm trying a model that
adds the categorical to the continuous features,
I could also try a model that
interacts the categorical with the continuous.
If you look closely,
I'm now pasting the linear additive
and the quadratic features inside this parentheses.
This model not only has
the linear features slopes depending on the categorical,
but it also has the quadratic feature slopes
depending on the categorical.
Let's not stop there, though.
Let's now consider a model where we add the categorical,
to a model that interacts each continuous input together.
I paste it in the same expression,
but then I wrapped another parentheses around
the linear main effect features
and raise that to the second power,
meaning create all linear additive main effects
and up to all pairwise products.
Next, if I can have x5 adding to
the linear main effects
with their pairwise products and all of the quadratics,
well, let's copy everything here,
everything with the continuous features,
that way we can interact
the categorical with all of those continuous features.
This is why the asterisk operator is so useful.
I don't have to type x5:x1 xy:x1:x2.
There are so many features getting created
here that it would
take a very long time to type this formula.
Now, you might be asking, well,
if you did this all pairwise,
is there anything else you
could do with the interactions?
The answer is yes. Instead of
just getting the pairwise products,
we could also get the triplet interaction.
The triplet is now going to
multiply three inputs together.
So **3, for example,
will multiply all combinations
of three of these inputs, x1,
x2, x3, x1, x2, x4,
so on and so forth.
Here I'm just adding x5 to all the triplets.
Let's do one more where I add
x5 to another set of additive and interaction features,
but now up to a four way interaction.
This is going to allow x1*x2*x3*x4.
It has linear main effects,
it has pairwise products,
it has triplet products,
and it has the four way interaction.
We've now seen interactions and we've seen polynomials,
let's conclude this example by
adding two very crazy looking models.
If I was adding x5, the categorical,
to the interactions of the continuous, well,
why don't I also
consider triplets that involve
the interactions of the categorical?
Because I can. There's nothing
limiting me from doing that here.
Likewise, I could consider up to four way interactions.
Now, let's wrap up with two very crazy looking models.
I'm going to interact x5
with a whole bunch of continuous features.
I'm going to use triplet interactions
between all four continuous inputs,
but I also want to create
quadratic features for each continuous input.
Let's be consistent. I wasn't using
a space previously, so I'll do the same thing.
x3^2+np power, x4^2.
Let me copy this cubic,
so I'm raising to the third power.
That's what I get for copying and pasting.
Three, three, three. Very good.
I have x5 interacting with
up to all three way or
triplet interactions of the inputs,
I have quadratic features,
and I have cubic features.
So x1^3, x2^3, so on and so forth.
Let's copy this whole formula,
the very last model,
x5 interacting with all triplets, the quadratics.
There we go. Let's just
keep this at the triplet interaction,
but I want to add in now np power x1^4+np power  x2^4+np
power x3^4+np power x4^4.
This last model is allowing for quadratic features,
cubic features, and quartic; fourth power features.