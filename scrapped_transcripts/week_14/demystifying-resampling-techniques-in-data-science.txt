Source: https://www.coursera.org/learn/mds-introduction-to-data-centric-computing/lecture/ZVXqM/demystifying-resampling-techniques-in-data-science

English
Now, these terms splits, averaging, randomly sub-setting.
They're just words right now,
and I want to introduce them to you,
but we will visualize and
see what all of these things mean here in a few minutes.
This process of replicating randomly
sampling rows or randomly
splitting the data is known as resampling.
That's its most general name.
We will specifically use
a resampling procedure known as K-fold cross-validation.
Now, we won't be doing
a lot of the random number calls manually,
we will rely on functions
to manage the random sampling for us.
Even though we are calling random number generators,
we're going to use some functions to
really help with some of the bookkeeping.
That said, you're going to see a lot of
programming in the examples this week.
Some of them I am doing just to teach you things.
Others are really to show how to do something.
Most of the rest of this video is being done
to teach you what K-fold cross-validation is doing.
You don't have to follow along for most of this video if
you follow along in
your own programming if you don't
want to because this is just to teach.
I would rather you pay attention
and learn the concepts than
try to get all the minor
programming details for this video.
There are a few things though that I want you
to see and practice programming,
and I will specifically tell you
what those are in this example.
Now, all that said, let's go ahead and
start executing or managing K-fold cross-validation.
We will import the function from a scikit-learn module.
Now, if we were working on a regression problem,
we would use the following function.
From sklearn.model_selection import KFold.
However, we are working on
a classification problem in this example,
so we need to use a different function.
From sklearn.model_selection import stratified KFold.
I'll talk about the distinctions
between these two shortly.
But if in regression problems,
you need KFold classification problems,
you need stratified KFold.
Now, both functions prefer to work with
NumPy arrays compared to Panda's dataframes.
Let's go ahead and create
a data frame just of the inputs,
which we will then convert to NumPy.
Input_df gets assigned.
I would like you to do this part.
Input_df gets assigned DF drop.
Drop the column y and copy.
Do a deep copy.
I'm removing or dropping the y column,
so this is just inputs.
We can convert the input_df data frame
to a NumPy array using the to_numpy method.
Just to demonstrate it here, input_df,
to_numpy it's a NumPy array.
Input_df, to_numpy.shape.
There are five columns and 300 rows,
so this has converted the data frame to a NumPy array.
Also, we need the output to be a NumPy array as well,
that is one dimensional.
If we go to df.y,
this is a Pandas series.
Convert the Pandas series to a NumPy array,
df.y to a NumPy.
Let's check the shape,
it's already one dimensional.
That's how we can have
a NumPy array for
the inputs and a NumPy array for the output.
Now, if we were working on a regression problem,
we would use the following syntax to
create five fold cross validation.
Now, I'll discuss what five fold means here shortly.
But I want to tell you, we're going
to do something five times.
We will call the KFold function,
and we will assign it to an object, kf_a.
There are three critical arguments to KFold.
First, n_splits.
This is how many times we will split
the data into training and test sets.
Five fold means split the data five times.
Then you must set shuffle equal to true,
and you need to set the random state.
Random state is what
controls the random number generator,
this is like setting the random seed.
Random state, I'm just using 101 here.
This object is a little weird.
This object understands how many times to split the data,
and we can confirm that with the get_n_splits method,
it says it will split the data five times.
But if you look closely,
we have not specified the data to split.
The KFold function has only been initialized.
It's only been initialized.
To split the data,
we need to call the.split method and
provide the input NumPy array.