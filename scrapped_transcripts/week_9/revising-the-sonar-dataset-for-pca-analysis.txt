Source: https://www.coursera.org/learn/mds-introduction-to-data-centric-computing/lecture/rvvLL/revising-the-sonar-dataset-for-pca-analysis

English
Hello everyone.
In this video we will revisit PCA to give a little more
insights into what's going on with it.
As you can see, I already have Jupyter up and running.
I'm in this week's directory.
Please launch a Jupyter notebook.
If you don't have Jupyter up and running, pause the recording, do so,
come back and then launch that Jupyter notebook.
And then let's rename this to week_09_review_pca.
Let's now put in the header information,
CMPINF 2100 week 09, review PCA with the sonar data set.
So I really like this data set because it helps introduce why PCA can be so useful.
Let's go ahead and import the modules.
Again, we need the big four import NumPy as NP, import pandas as PD,
import matplotlib.pyplot as PLT, and import seabourn as SNS.
Let's also import functions from Sklearn.
We need from sklearn.preprocessing
import standard scalar.
Then sklearn from sklearn.decomposition import PCA.
In order to read in the data for this example,
I again have the HTML file from last week's PCA intro.
In that file I have the URL to the sonar dataset.
Again this link was provided last week.
Please copy this entire line of code.
Everything in this cell go to the current Jupyter notebook.
Let's put in the header of read data and
I'm just going to paste in that variable which is assigned that string and
that string is the download the URL link.
Now let's read in the data set using the pd read CSV function from that URL.
But as mentioned last week, we need to set header to
none because that CSV file does not have a header row.
This data frame has 61 columns.
Has a large number of columns, and
as discussed last week,
let's rename the columns to show
the following pattern of x01,
then x02, x03, so on and so on.
To do that, we will change the column's attribute using a list comprehension.
Where the action is create a string x%02d
where the percent is a placeholder.
I want to have two digits with two places
zero padding on the left if there's only one for
some digit d, for d in sonar df.columns.
This works because if I put in another cell and
then print out to you the columns attribute,
the columns is just an integer zero through 60.
So I'm taking that column iterating over that sequence and
using each one to create this string.
Now the columns are not zero through 60, they are x00 through x60.
Also as a reminder, there's one
object column in this data set.
If we select that object column and apply the info method,
you can see it's the very last column, x 60.
This is not numeric because for
this application that column stores whether
the observation was from a rock or a piece of metal.
Because sonar, the zero through 59, those are features from sonar signals.
But for our purposes, the main aspect of using this data set for
now is that the numeric columns are highly correlated.
Let's look at that correlation structure through
a correlation plot created from a heat map.
The data to the heat map is the result of
the core method applied to the numeric columns.
When making a heat map, you should always have the lower bound for
the color to be negative one, the upper bound for
the color to be one with the center point to be zero.
And you must use a diverging color palette.
All of the bright reds are high correlation as you can see,
we have this pattern of each subsequent variable.
Each subsequent column is highly correlated to the one before it,
the one after it throughout most of the data set.
There's also this kind of structure of a group that's uncorrelated to
another group.
That's what you see with the blue and the off diagonal.
PCA exploits correlation.
PCA crafts or creates new variables
based on correlated numeric columns.
That's really what it's trying to do.
So let's go ahead and extract or select the numeric columns.
Let's pull them out.
I'll call this dataframe.
Sonar features, sonar df,
select dtypes number, enforce the deep copy.
And now let's standardize the numeric features.
Assign the result to x sonar standard scalar fit and
transform the sonar features.
X sonar has as many columns as, let me put this
in as in the data set that we provided to it.
So 60 columns and 60 columns.